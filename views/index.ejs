<!DOCTYPE html>
<html>
<head>
	<title>Notes</title>

	<!--Import Google Icon Font-->
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--Import materialize.css-->
	<link type="text/css" rel="stylesheet" href="/stylesheets/lib/materialize.min.css"  media="screen,projection"/>
	<!--Import base style.css-->
	<link type="text/css" rel="stylesheet" href="/stylesheets/style.css"  media="screen,projection"/>

	<!--Let browser know website is optimized for mobile-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body ng-app="notes">
	<nav ng-controller="NavCtrl">
		<div class="nav-wrapper yellow">
			<a href id="brand" class="brand-logo grey-text">Notes</a>
			<a href="#" data-activates="mobile-demo" class="button-collapse"><i id="hamburger" class="material-icons grey-text">menu</i></a>
			<ul class="right hide-on-med-and-down">
				<li ng-show="isLoggedIn()"><a href class="grey-text">Logged in as: {{ currentUser() }}</a></li>
				<li ng-show="isLoggedIn()"><a href class="grey-text" ng-click="logOut()">Log out</a></li>
				<li ng-hide="isLoggedIn()"><a href="/#/login" class="grey-text">Log in</a></li>
				<li ng-hide="isLoggedIn()"><a href="/#/register" class="grey-text">Register</a></li>
			</ul>
			<ul class="side-nav" id="mobile-demo">
				<li ng-show="isLoggedIn()"><a href class="grey-text">Logged in as: {{ currentUser() }}</a></li>
				<li ng-show="isLoggedIn()"><a href="" class="grey-text" ng-click="logOut()">Log out</a></li>
				<li ng-hide="isLoggedIn()"><a href="/#/login" class="grey-text">Log in</a></li>
				<li ng-hide="isLoggedIn()"><a href="/#/register" class="grey-text">Register</a></li>
			</ul>
		</div>
	</nav>
	<div class="container">
		<div class="row">
			<div class="col s12">
				<ui-view></ui-view>
			</div>
		</div>
	</div>
	<script type="text/ng-template" id="/home.html">
		<div ng-show="loading > 0" class="preloader-wrapper active">
    		<div class="spinner-layer spinner-red-only">
      			<div class="circle-clipper left">
        			<div class="circle"></div>
      			</div><div class="gap-patch">
        	<div class="circle"></div>
      		</div><div class="circle-clipper right">
        		<div class="circle"></div>
      		</div>
    		</div>
  		</div>
		<div class="row" ng-show="loading == 0" style="padding-top: 16px;">
			<div class="col s12 m4 offset-m4">
				<div class="card black-text">
					<div class="card-content black-text">
						<span class="card-title grey-text">Add a new note</span>
						<div class="row">
							<div class="col s12" style="padding-bottom: 16px;">
								<ul class="tabs">
									<li class="tab col s3"><a class="active" ng-click="changeNoteType(0)"
									href="#normal-note"><i class="material-icons grey-text">mode_edit</i></a></li>
									<li class="tab col s3"><a ng-click="changeNoteType(1)"
									href="#list-note"><i class="material-icons grey-text">list</i></a></li>
								</ul>
							</div>
							<div class="col s12">
								<input placeholder="Title" ng-model="newNote.title" type="text">
							</div>
							<div id="normal-note" class="col s12">
								<textarea class="materialize-textarea" placeholder="Content" ng-model="newNote.body"></textarea>
							</div>
							<div id="list-note" class="col s12">
								<div ng-repeat="task in newNote.tasks" ng-attr-id="{{ 'task-' + task.id }}">
								<div class="input-field">
         							<i href ng-if="$index > 0" ng-click="deleteTask(task)" class="material-icons prefix grey-text">delete</i>
          							<input placeholder="Write a task.." ng-model="task.task"/>	
        						</div>					
								</div>
								<div class="col s12 right-align">
									<a href ng-click="addTask()" class="grey-text light">Add task</a>
								</div>
							</div>
						</div>
					</div>
					<div class="card-action">
						<a class="grey-text" href ng-click="addNote()">ADD NOTE</a>
					</div>
					</div
				</div>
			</div>
		</div>
		<div class="row" ng-show="loading == 0">
			<div class="col s12 m3" ng-repeat="note in notes | orderBy:'-date'">
				<div class="card hoverable yellow">
					<div class="card-content grey-text">
						<span class="card-title grey-text">{{note.title}}</span>
						<div ng-if="note.noteType == 0">
							<p class="grey-text note-body">{{note.body}}</p>
						</div>
						<div ng-if="note.noteType == 1" ng-repeat="task in note.taskList">
    						<p class="grey-text">
      							<input ng-model="task.finished" ng-change="updateNote(note)" type="checkbox" id="{{ 'task-' + task._id }}" />
      							<label for="{{ 'task-' + task._id }}">{{task.task}}</label>
    						</p>	
						</div>
						<h6 class="light grey-text" am-time-ago="note.date"></h6>
					</div>
					<div class="card-action">
						<a class="grey-text" href><i class="material-icons">mode_edit</i></a>
						<a class="grey-text" href><i class="material-icons">invert_colors</i></a>
						<a class="grey-text" href><i class="material-icons">mail</i></a>
						<a class="grey-text" href><i class="material-icons">done</i></a>
						<a class="grey-text" href ng-click="deleteNote(note)"><i class="material-icons">delete</i></a>
					</div>
				</div>
			</div>
			<div class="col s12 m4 offset-m4" ng-show="notes.length == 0">
				<div class="card-panel hoverable green lighten-2 white-text">
					Go ahead, add your first note!
				</div>
			</div>
		</div>
	</script>
	<script type="text/ng-template" id="/register.html">

		<div class="row">
			<div class="col s12 m4 offset-m4">

				<div class="card-panel red lighten-2 white-text" ng-show="error">
					<span>{{ error.message }}</span>
				</div>

				<form ng-submit="register()">
					<div class="row center-align">
						<h3 class="bold">Register</h3>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<input type="text"
							id="username"
							ng-model="user.username"></input>
							<label for="username">Username</label>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<input type="password"
							id="password"
							ng-model="user.password"></input>
							<label for="password">Password</label>
						</div>
					</div>
					<div class="row">
						<div class="col s8">
							<a href="/#/login" class="grey-text regular">I already have an account</a>
						</div>
						<div class="col s4">
							<button class="btn waves-effect waves-light" type="submit" name="action">Done
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</script>
	<script type="text/ng-template" id="/login.html">
		<div class="row">
			<div class="col s12 m4 offset-m4">

				<div class="card-panel red lighten-2 white-text" ng-show="error">
					<span>{{ error.message }}</span>
				</div>

				<form ng-submit="logIn()">
					<div class="row center-align">
						<h3 class="bold">Log In</h3>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<input type="text"
							id="username"
							ng-model="user.username"></input>
							<label for="username">Username</label>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<input type="password"
							id="password"
							ng-model="user.password"></input>
							<label for="password">Password</label>
						</div>
					</div>
					<div class="row">
						<div class="col s8">
							<a href="/#/register" class="grey-text regular">I do not have an account</a>
						</div>
						<div class="col s4">
							<button class="btn waves-effect waves-light" type="submit" name="action">Login
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</script>
	<!--Import jQuery before materialize.js-->
	<script src="/javascripts/lib/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="/javascripts/lib/materialize.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.10/angular.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.10/angular-ui-router.js"></script>
	<script src="/javascripts/angularApp.js"></script>
	<script src="/javascripts/base.js"></script>
	<script src="/javascripts/lib/moment.min.js"></script>
	<script src="/javascripts/lib/angular-moment.min.js"></script>
</body>
</html>